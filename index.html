<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LAP SEQUENCER by Lap.comp & B the B © 2026</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pizzicato/0.6.4/Pizzicato.min.css">
    <style>
        /* === ГЛОБАЛЬНЫЕ СТИЛИ === */
        :root {
            --primary: #00ffaa;
            --secondary: #00a8ff;
            --accent: #ffaa00;
            --dark: #0a0a12;
            --darker: #07070e;
            --panel: #1a1a2e;
            --light: #2d2d44;
            --text: #e0e0ff;
            --red: #ff5555;
            --green: #55ff55;
            --blue: #5555ff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            font-family: 'Segoe UI', 'Arial', sans-serif;
        }

        body {
            background: var(--dark);
            color: var(--text);
            height: 100vh;
            overflow: hidden;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(0, 255, 170, 0.03) 0%, transparent 25%),
                radial-gradient(circle at 90% 80%, rgba(0, 168, 255, 0.03) 0%, transparent 25%);
        }

        /* === ШАПКА === */
        .brand-header {
            background: linear-gradient(90deg, #000814 0%, #001d3d 50%, #000814 100%);
            padding: 10px 20px;
            border-bottom: 2px solid var(--primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 50px;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            font-size: 24px;
            font-weight: 900;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 1px;
        }

        .logo-subtitle {
            font-size: 11px;
            color: #8a8aff;
            font-weight: 300;
            letter-spacing: 2px;
        }

        .year-badge {
            background: rgba(0, 255, 170, 0.1);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            border: 1px solid rgba(0, 255, 170, 0.3);
        }

        /* === ОСНОВНОЙ КОНТЕЙНЕР === */
        .main-container {
            display: flex;
            height: calc(100vh - 90px);
        }

        /* === ЛЕВАЯ ПАНЕЛЬ: БРАУЗЕР === */
        .file-browser {
            width: 300px;
            background: rgba(20, 20, 35, 0.95);
            border-right: 1px solid var(--light);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .browser-header {
            padding: 15px;
            border-bottom: 1px solid var(--light);
        }

        .browser-title {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--primary);
            font-size: 14px;
            margin-bottom: 8px;
        }

        .sound-controls {
            padding: 10px 15px;
            display: flex;
            gap: 10px;
            border-bottom: 1px solid var(--light);
        }

        .search-input {
            flex: 1;
            background: rgba(40, 40, 60, 0.7);
            border: 1px solid var(--light);
            color: var(--text);
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
        }

        .refresh-btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .drum-kit-section {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
        }

        .folder-item {
            background: rgba(30, 30, 50, 0.8);
            border-radius: 8px;
            margin-bottom: 10px;
            overflow: hidden;
            border: 1px solid rgba(60, 60, 90, 0.5);
        }

        .folder-header {
            padding: 10px 15px;
            background: rgba(40, 40, 70, 0.9);
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            color: var(--secondary);
            font-weight: 500;
        }

        .sound-items {
            max-height: 300px;
            overflow-y: auto;
            padding: 5px;
            display: none;
        }

        .sound-item {
            display: flex;
            align-items: center;
            padding: 8px 10px;
            margin: 4px 0;
            background: rgba(45, 45, 70, 0.6);
            border-radius: 6px;
            cursor: grab;
            transition: all 0.2s;
            border: 1px dashed transparent;
            font-size: 12px;
        }

        .sound-item:hover {
            background: rgba(60, 60, 100, 0.8);
            border-color: var(--primary);
            transform: translateX(5px);
        }

        .sound-icon {
            color: var(--secondary);
            margin-right: 10px;
            width: 16px;
            text-align: center;
        }

        /* === ЦЕНТРАЛЬНАЯ ЧАСТЬ === */
        .workspace {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--darker);
            overflow: hidden;
        }

        /* === TRANSPORT BAR === */
        .transport-bar {
            background: rgba(25, 25, 40, 0.95);
            padding: 10px 20px;
            display: flex;
            align-items: center;
            gap: 20px;
            border-bottom: 1px solid var(--light);
        }

        .play-btn {
            background: var(--primary);
            color: black;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: none;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .play-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(0, 255, 170, 0.5);
        }

        .bpm-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .bpm-value {
            font-size: 22px;
            color: var(--primary);
            min-width: 45px;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(0, 255, 170, 0.3);
        }

        input[type="range"] {
            width: 140px;
            accent-color: var(--primary);
        }

        .metro-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-left: 30px;
        }

        .metro-btn {
            background: rgba(60, 60, 90, 0.7);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 100px;
        }

        .metro-btn.active {
            background: var(--accent);
            color: black;
        }

        .transport-right {
            margin-left: auto;
            display: flex;
            gap: 10px;
        }

        .transport-btn {
            background: rgba(60, 60, 90, 0.7);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s;
        }

        .transport-btn:hover {
            background: rgba(80, 80, 120, 0.9);
        }

        /* === ПАНЕЛЬ ПАТТЕРНОВ === */
        .patterns-bar {
            background: rgba(30, 30, 50, 0.9);
            padding: 8px 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 1px solid var(--light);
        }

        .pattern-label {
            color: var(--secondary);
            font-size: 12px;
            min-width: 70px;
        }

        .pattern-list {
            display: flex;
            gap: 5px;
            flex: 1;
            overflow-x: auto;
            padding: 5px 0;
        }

        .pattern-btn {
            background: rgba(50, 50, 80, 0.7);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            min-width: 80px;
            text-align: center;
            border: 1px solid transparent;
        }

        .pattern-btn.active {
            background: var(--primary);
            color: black;
            border-color: var(--primary);
        }

        .pattern-btn:hover {
            background: rgba(70, 70, 110, 0.9);
        }

        /* === CHANNEL RACK (БОЛЬШОЙ) === */
        .channel-rack-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .rack-header {
            padding: 10px 15px;
            background: rgba(35, 35, 55, 0.9);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--light);
        }

        .rack-title {
            color: var(--primary);
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .rack-controls {
            display: flex;
            gap: 10px;
        }

        .rack-control-btn {
            background: rgba(60, 60, 90, 0.7);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .rack-control-btn:hover {
            background: rgba(80, 80, 120, 0.9);
        }

        .rack-control-btn.delete {
            background: rgba(255, 85, 85, 0.2);
            color: #ff5555;
        }

        .rack-control-btn.delete:hover {
            background: rgba(255, 85, 85, 0.4);
        }

        .channel-rack {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .channel {
            background: rgba(40, 40, 65, 0.8);
            border-radius: 8px;
            padding: 12px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-left: 4px solid transparent;
            transition: all 0.2s;
            border: 1px solid rgba(60, 60, 90, 0.5);
        }

        .channel.active {
            border-left-color: var(--primary);
            background: rgba(40, 65, 65, 0.8);
        }

        .channel-mute {
            color: var(--red);
            cursor: pointer;
            width: 20px;
            font-size: 18px;
        }

        .channel-mute.muted {
            color: #888;
        }

        .channel-info {
            min-width: 180px;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .channel-name {
            color: var(--secondary);
            font-weight: 500;
            font-size: 13px;
        }

        .channel-path {
            color: #888;
            font-size: 11px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 200px;
        }

        .step-sequencer {
            flex: 1;
            display: flex;
            gap: 4px;
            height: 40px;
        }

        .step {
            flex: 1;
            background: rgba(60, 60, 90, 0.5);
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.1s;
            border: 1px solid rgba(80, 80, 120, 0.3);
            min-width: 25px;
        }

        .step:hover {
            background: rgba(80, 80, 120, 0.7);
            transform: scale(1.05);
        }

        .step.active {
            background: var(--primary);
            box-shadow: 0 0 8px rgba(0, 255, 170, 0.5);
        }

        .step.active-step {
            background: var(--accent);
            box-shadow: 0 0 10px rgba(255, 170, 0, 0.6);
        }

        .channel-controls {
            display: flex;
            gap: 10px;
            min-width: 200px;
        }

        .channel-slider {
            flex: 1;
            min-width: 100px;
        }

        .channel-delete {
            color: var(--red);
            cursor: pointer;
            width: 30px;
            text-align: center;
            font-size: 16px;
            opacity: 0.5;
        }

        .channel-delete:hover {
            opacity: 1;
            transform: scale(1.2);
        }

        /* === ПАНЕЛЬ ПЛАГИНОВ === */
        .plugins-panel {
            background: rgba(25, 25, 40, 0.95);
            padding: 10px 15px;
            display: flex;
            gap: 10px;
            border-top: 1px solid var(--light);
            height: 50px;
            overflow-x: auto;
        }

        .plugin-tab {
            background: rgba(50, 50, 80, 0.7);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
            border: 1px solid transparent;
        }

        .plugin-tab:hover {
            background: rgba(70, 70, 110, 0.9);
        }

        .plugin-tab.active {
            background: var(--primary);
            color: black;
            border-color: var(--primary);
        }

        /* === МИКШЕР === */
        .mixer-panel {
            width: 350px;
            background: rgba(20, 20, 35, 0.95);
            border-left: 1px solid var(--light);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .mixer-header {
            padding: 15px;
            border-bottom: 1px solid var(--light);
        }

        .mixer-title {
            color: var(--primary);
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mixer-channels {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .mixer-channel {
            background: rgba(35, 35, 55, 0.8);
            border-radius: 8px;
            padding: 15px;
            border: 1px solid rgba(60, 60, 90, 0.5);
        }

        .mixer-channel.master {
            background: rgba(45, 35, 55, 0.9);
            border-color: var(--primary);
        }

        .mixer-channel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .mixer-channel-name {
            color: var(--secondary);
            font-size: 13px;
            font-weight: 500;
        }

        .mixer-channel-value {
            color: var(--primary);
            font-size: 11px;
            font-family: monospace;
        }

        .mixer-slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mixer-slider {
            flex: 1;
            height: 150px;
            -webkit-appearance: slider-vertical;
            width: 20px;
        }

        .mixer-plugins {
            margin-top: 10px;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .mixer-plugin {
            background: rgba(60, 60, 90, 0.5);
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            cursor: pointer;
        }

        .mixer-plugin:hover {
            background: rgba(80, 80, 120, 0.7);
        }

        /* === ОКНА ПЛАГИНОВ === */
        .plugin-window-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }

        .plugin-window {
            background: var(--panel);
            border-radius: 12px;
            width: 600px;
            max-width: 90%;
            max-height: 80%;
            overflow: hidden;
            border: 2px solid var(--light);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .plugin-header {
            background: linear-gradient(90deg, #001d3d, #003d7d);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--light);
        }

        .plugin-title {
            color: var(--primary);
            font-size: 16px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .plugin-close {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .plugin-close:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .plugin-content {
            padding: 20px;
            max-height: 500px;
            overflow-y: auto;
        }

        .plugin-section {
            margin-bottom: 20px;
        }

        .plugin-label {
            color: var(--secondary);
            margin-bottom: 10px;
            font-size: 14px;
            display: block;
        }

        .plugin-knob {
            width: 60px;
            height: 60px;
            background: rgba(40, 40, 60, 0.8);
            border-radius: 50%;
            position: relative;
            margin: 10px auto;
            border: 2px solid var(--light);
        }

        .plugin-slider {
            width: 100%;
            margin: 10px 0;
        }

        /* === ПИАНО РОЛЛ === */
        .piano-roll-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            z-index: 1000;
        }

        .piano-roll-container {
            background: #111122;
            width: 95%;
            height: 95%;
            margin: 20px auto;
            border-radius: 10px;
            border: 2px solid var(--primary);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .piano-roll-header {
            background: #1a1a2e;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--primary);
        }

        .piano-roll-content {
            flex: 1;
            overflow: auto;
            position: relative;
        }

        /* === ФУТЕР === */
        .footer {
            background: #000814;
            padding: 8px 20px;
            border-top: 1px solid #1a1a2e;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 40px;
            font-size: 11px;
            color: #6a6a8a;
        }

        .copyright {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .brands {
            display: flex;
            gap: 15px;
        }

        .brand {
            color: var(--secondary);
            font-weight: 500;
            letter-spacing: 0.5px;
        }

        .status-bar {
            display: flex;
            gap: 20px;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* === АДАПТИВНОСТЬ === */
        @media (max-width: 1400px) {
            .mixer-panel {
                width: 300px;
            }
            .file-browser {
                width: 250px;
            }
            .channel-info {
                min-width: 150px;
            }
        }

        /* === АНИМАЦИИ === */
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .playing {
            animation: pulse 0.5s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .recording {
            animation: blink 1s infinite;
            color: var(--red) !important;
        }
    </style>
</head>
<body>
    <!-- ШАПКА -->
    <div class="brand-header">
        <div class="logo-container">
            <div class="logo">LAP SEQUENCER</div>
            <div class="logo-subtitle">WEB DAW v3.0.26</div>
        </div>
        <div class="year-badge">© 2026 Lap.comp × B the B</div>
    </div>

    <!-- ОСНОВНОЙ КОНТЕЙНЕР -->
    <div class="main-container">
        <!-- ЛЕВАЯ ПАНЕЛЬ: БРАУЗЕР ЗВУКОВ -->
        <div class="file-browser" id="fileBrowser">
            <div class="browser-header">
                <div class="browser-title">
                    <i class="fas fa-folder-open"></i>
                    <span>SOUND LIBRARY</span>
                </div>
                <div class="browser-info" id="soundCount">Scanning GitHub...</div>
            </div>
            
            <div class="sound-controls">
                <input type="text" id="searchInput" placeholder="Search sounds..." class="search-input">
                <button id="refreshBtn" class="refresh-btn" title="Rescan sounds folder">
                    <i class="fas fa-sync-alt"></i>
                </button>
            </div>
            
            <div class="drum-kit-section" id="soundList">
                <!-- Звуки загружаются динамически -->
                <div class="loading-sounds">
                    <i class="fas fa-spinner fa-spin"></i>
                    Loading sounds from GitHub...
                </div>
            </div>
        </div>

        <!-- ЦЕНТРАЛЬНАЯ РАБОЧАЯ ОБЛАСТЬ -->
        <div class="workspace">
            <!-- TRANSPORT BAR -->
            <div class="transport-bar">
                <button class="play-btn" id="playBtn">
                    <i class="fas fa-play"></i>
                </button>
                
                <div class="bpm-control">
                    <span>BPM:</span>
                    <div class="bpm-value" id="bpmValue">128</div>
                    <input type="range" id="bpmSlider" min="60" max="200" value="128">
                </div>
                
                <div class="metro-controls">
                    <button id="metronomeBtn" class="metro-btn">
                        <i class="fas fa-volume-up"></i> METRONOME
                    </button>
                    <input type="range" id="metroVolume" min="0" max="100" value="50">
                </div>
                
                <div class="transport-right">
                    <button class="transport-btn" id="recordBtn" title="Record (R)">
                        <i class="fas fa-circle"></i>
                    </button>
                    <button class="transport-btn" id="loopBtn" title="Loop (L)" class="active">
                        <i class="fas fa-redo"></i>
                    </button>
                    <button class="transport-btn" id="saveBtn" title="Save Project (Ctrl+S)">
                        <i class="fas fa-save"></i>
                    </button>
                    <button class="transport-btn" id="loadBtn" title="Load Project (Ctrl+O)">
                        <i class="fas fa-folder-open"></i>
                    </button>
                </div>
            </div>

            <!-- ПАНЕЛЬ ПАТТЕРНОВ -->
            <div class="patterns-bar">
                <div class="pattern-label">
                    <i class="fas fa-layer-group"></i> PATTERNS:
                </div>
                <div class="pattern-list" id="patternList">
                    <!-- Паттерны генерируются динамически -->
                </div>
                <button id="addPatternBtn" class="pattern-btn" style="background: var(--primary); color: black;">
                    <i class="fas fa-plus"></i> ADD
                </button>
            </div>

            <!-- CHANNEL RACK -->
            <div class="channel-rack-container">
                <div class="rack-header">
                    <div class="rack-title">
                        <i class="fas fa-sliders-h"></i> CHANNEL RACK
                        <span id="channelCount" style="color: #888; font-size: 12px;">(0 channels)</span>
                    </div>
                    <div class="rack-controls">
                        <button class="rack-control-btn" id="clearRackBtn">
                            <i class="fas fa-trash"></i> Clear All
                        </button>
                        <button class="rack-control-btn" id="addDrumBtn">
                            <i class="fas fa-plus"></i> Add Drum
                        </button>
                        <button class="rack-control-btn" id="addSynthBtn">
                            <i class="fas fa-plus"></i> Add Synth
                        </button>
                        <button class="rack-control-btn delete" id="deleteSelectedBtn">
                            <i class="fas fa-times"></i> Delete Selected
                        </button>
                    </div>
                </div>
                
                <div class="channel-rack" id="channelRack">
                    <!-- Каналы добавляются динамически -->
                    <div class="empty-rack" style="text-align: center; padding: 40px; color: #666;">
                        <i class="fas fa-sliders-h" style="font-size: 48px; margin-bottom: 20px; display: block;"></i>
                        Drag & drop sounds here or add instruments
                    </div>
                </div>
            </div>

            <!-- ПАНЕЛЬ ПЛАГИНОВ -->
            <div class="plugins-panel">
                <button class="plugin-tab active" data-plugin="3xosc" onclick="openPlugin('3xosc')">
                    <i class="fas fa-wave-square"></i> 3xOSC
                </button>
                <button class="plugin-tab" data-plugin="flkeys" onclick="openPlugin('flkeys')">
                    <i class="fas fa-keyboard"></i> FL Keys
                </button>
                <button class="plugin-tab" data-plugin="eq" onclick="openPlugin('eq')">
                    <i class="fas fa-chart-line"></i> Parametric EQ 2
                </button>
                <button class="plugin-tab" data-plugin="compressor" onclick="openPlugin('compressor')">
                    <i class="fas fa-compress-alt"></i> Compressor
                </button>
                <button class="plugin-tab" data-plugin="reverb" onclick="openPlugin('reverb')">
                    <i class="fas fa-mountain"></i> Reverb
                </button>
                <button class="plugin-tab" data-plugin="delay" onclick="openPlugin('delay')">
                    <i class="fas fa-reply"></i> Delay
                </button>
                <button class="plugin-tab" data-plugin="limiter" onclick="openPlugin('limiter')">
                    <i class="fas fa-tachometer-alt"></i> Limiter
                </button>
                <button class="plugin-tab" onclick="openPianoRoll()">
                    <i class="fas fa-music"></i> Piano Roll
                </button>
            </div>
        </div>

        <!-- ПРАВАЯ ПАНЕЛЬ: МИКШЕР -->
        <div class="mixer-panel">
            <div class="mixer-header">
                <div class="mixer-title">
                    <i class="fas fa-sliders-h"></i> MIXER
                </div>
            </div>
            
            <div class="mixer-channels">
                <!-- Master канал -->
                <div class="mixer-channel master">
                    <div class="mixer-channel-header">
                        <div class="mixer-channel-name">MASTER</div>
                        <div class="mixer-channel-value" id="masterVolume">0.0 dB</div>
                    </div>
                    <div class="mixer-slider-container">
                        <input type="range" class="mixer-slider" id="masterSlider" min="-60" max="6" value="0" orient="vertical">
                    </div>
                    <div class="mixer-plugins">
                        <button class="mixer-plugin" onclick="openPlugin('limiter')">Limiter</button>
                        <button class="mixer-plugin" onclick="openPlugin('eq')">EQ</button>
                    </div>
                </div>
                
                <!-- Каналы микшера генерируются динамически -->
                <div id="mixerChannels"></div>
            </div>
        </div>
    </div>

    <!-- ОКНА ПЛАГИНОВ -->
    <div class="plugin-window-overlay" id="pluginOverlay">
        <!-- 3xOSC -->
        <div class="plugin-window" id="plugin3xosc" style="display: none;">
            <div class="plugin-header">
                <div class="plugin-title">
                    <i class="fas fa-wave-square"></i> 3xOSC - Triple Oscillator Synthesizer
                </div>
                <button class="plugin-close" onclick="closePlugin()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="plugin-content">
                <div class="plugin-section">
                    <label class="plugin-label">OSCILLATOR 1</label>
                    <select class="plugin-select" id="osc1Wave">
                        <option value="sine">Sine</option>
                        <option value="sawtooth">Sawtooth</option>
                        <option value="square" selected>Square</option>
                        <option value="triangle">Triangle</option>
                    </select>
                    <input type="range" class="plugin-slider" id="osc1Volume" min="0" max="100" value="100">
                </div>
                <div class="plugin-section">
                    <label class="plugin-label">OSCILLATOR 2</label>
                    <select class="plugin-select" id="osc2Wave">
                        <option value="sine">Sine</option>
                        <option value="sawtooth" selected>Sawtooth</option>
                        <option value="square">Square</option>
                        <option value="triangle">Triangle</option>
                    </select>
                    <input type="range" class="plugin-slider" id="osc2Volume" min="0" max="100" value="80">
                </div>
                <div class="plugin-section">
                    <label class="plugin-label">OSCILLATOR 3</label>
                    <select class="plugin-select" id="osc3Wave">
                        <option value="sine">Sine</option>
                        <option value="sawtooth">Sawtooth</option>
                        <option value="square">Square</option>
                        <option value="triangle" selected>Triangle</option>
                    </select>
                    <input type="range" class="plugin-slider" id="osc3Volume" min="0" max="100" value="60">
                </div>
                <div class="plugin-section">
                    <label class="plugin-label">FILTER</label>
                    <input type="range" class="plugin-slider" id="filterCutoff" min="0" max="100" value="100">
                    <input type="range" class="plugin-slider" id="filterResonance" min="0" max="100" value="0">
                </div>
                <button class="plugin-test-btn" onclick="testSynth()" style="background: var(--primary); color: black; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; margin-top: 20px;">
                    <i class="fas fa-play"></i> Test Sound
                </button>
            </div>
        </div>

        <!-- FL Keys -->
        <div class="plugin-window" id="pluginFlkeys" style="display: none;">
            <div class="plugin-header">
                <div class="plugin-title">
                    <i class="fas fa-keyboard"></i> FL Keys - Piano & Electric Piano
                </div>
                <button class="plugin-close" onclick="closePlugin()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="plugin-content">
                <div class="plugin-section">
                    <label class="plugin-label">INSTRUMENT PRESET</label>
                    <select class="plugin-select" id="pianoPreset">
                        <option value="grand">Grand Piano</option>
                        <option value="electric" selected>Electric Piano</option>
                        <option value="bright">Bright Piano</option>
                        <option value="honky">Honky Tonk</option>
                    </select>
                </div>
                <div class="plugin-section">
                    <label class="plugin-label">VOLUME</label>
                    <input type="range" class="plugin-slider" id="pianoVolume" min="0" max="100" value="80">
                </div>
                <div class="plugin-section">
                    <label class="plugin-label">REVERB</label>
                    <input type="range" class="plugin-slider" id="pianoReverb" min="0" max="100" value="30">
                </div>
                <div style="display: flex; gap: 5px; margin-top: 20px; flex-wrap: wrap;">
                    <button class="piano-key" data-note="C4" style="background: white; color: black; width: 40px; height: 120px; border: 1px solid #ccc;">C</button>
                    <button class="piano-key" data-note="D4" style="background: white; color: black; width: 40px; height: 120px; border: 1px solid #ccc;">D</button>
                    <button class="piano-key" data-note="E4" style="background: white; color: black; width: 40px; height: 120px; border: 1px solid #ccc;">E</button>
                    <button class="piano-key" data-note="F4" style="background: white; color: black; width: 40px; height: 120px; border: 1px solid #ccc;">F</button>
                    <button class="piano-key" data-note="G4" style="background: white; color: black; width: 40px; height: 120px; border: 1px solid #ccc;">G</button>
                </button>
            </div>
        </div>

        <!-- Parametric EQ 2 -->
        <div class="plugin-window" id="pluginEq" style="display: none;">
            <div class="plugin-header">
                <div class="plugin-title">
                    <i class="fas fa-chart-line"></i> Fruity Parametric EQ 2
                </div>
                <button class="plugin-close" onclick="closePlugin()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="plugin-content">
                <div style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; margin-bottom: 20px;">
                    <div class="eq-band">
                        <div style="text-align: center; color: var(--secondary); font-size: 12px;">31Hz</div>
                        <input type="range" class="eq-slider" orient="vertical" min="-24" max="24" value="0">
                    </div>
                    <div class="eq-band">
                        <div style="text-align: center; color: var(--secondary); font-size: 12px;">63Hz</div>
                        <input type="range" class="eq-slider" orient="vertical" min="-24" max="24" value="0">
                    </div>
                    <div class="eq-band">
                        <div style="text-align: center; color: var(--secondary); font-size: 12px;">125Hz</div>
                        <input type="range" class="eq-slider" orient="vertical" min="-24" max="24" value="0">
                    </div>
                    <div class="eq-band">
                        <div style="text-align: center; color: var(--secondary); font-size: 12px;">250Hz</div>
                        <input type="range" class="eq-slider" orient="vertical" min="-24" max="24" value="0">
                    </div>
                    <div class="eq-band">
                        <div style="text-align: center; color: var(--secondary); font-size: 12px;">500Hz</div>
                        <input type="range" class="eq-slider" orient="vertical" min="-24" max="24" value="0">
                    </div>
                    <div class="eq-band">
                        <div style="text-align: center; color: var(--secondary); font-size: 12px;">1kHz</div>
                        <input type="range" class="eq-slider" orient="vertical" min="-24" max="24" value="0">
                    </div>
                    <div class="eq-band">
                        <div style="text-align: center; color: var(--secondary); font-size: 12px;">16kHz</div>
                        <input type="range" class="eq-slider" orient="vertical" min="-24" max="24" value="0">
                    </div>
                </div>
                <button class="plugin-btn" onclick="resetEQ()" style="background: var(--secondary); color: white; border: none; padding: 8px 15px; border-radius: 6px; cursor: pointer;">
                    <i class="fas fa-undo"></i> Reset All
                </button>
            </div>
        </div>
    </div>

    <!-- ПИАНО РОЛЛ -->
    <div class="piano-roll-overlay" id="pianoRollOverlay">
        <div class="piano-roll-container">
            <div class="piano-roll-header">
                <h2 style="color: var(--primary);"><i class="fas fa-music"></i> PIANO ROLL</h2>
                <button onclick="closePianoRoll()" style="background: var(--red); color: white; border: none; padding: 8px 15px; border-radius: 6px; cursor: pointer;">
                    <i class="fas fa-times"></i> Close
                </button>
            </div>
            <div class="piano-roll-content" id="pianoRollContent">
                <!-- Пиано ролл рендерится здесь -->
                <div style="padding: 20px; text-align: center; color: #666;">
                    Piano Roll - Draw MIDI notes here
                </div>
            </div>
        </div>
    </div>

    <!-- ФУТЕР -->
    <div class="footer">
        <div class="copyright">
            <span>© 2026 All rights reserved</span>
        </div>
        <div class="brands">
            <span class="brand">Lap.comp</span>
            <span style="color: #555;">×</span>
            <span class="brand">B the B</span>
        </div>
        <div class="status-bar">
            <div class="status-item">
                <i class="fas fa-microchip"></i>
                <span id="cpuUsage">CPU: 12%</span>
            </div>
            <div class="status-item">
                <i class="fas fa-music"></i>
                <span id="activeChannels">Channels: 0</span>
            </div>
            <div class="status-item">
                <i class="fas fa-save"></i>
                <span id="lastSaved">Auto-saved</span>
            </div>
        </div>
    </div>

    <!-- SCRIPTS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tonejs/ui@0.1.5/build/ToneUI.js"></script>
    <script src="script.js"></script>
</body>
</html>
